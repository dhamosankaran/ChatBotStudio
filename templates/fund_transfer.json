{
    "start_screen_id": "select_transfer_type",
    "screens": {
        "select_transfer_type": {
            "screen_id": "select_transfer_type",
            "type": "MENU",
            "message_text": "ğŸ’¸ Transfer Funds\n\nWhat type of transfer would you like to make?",
            "buttons": [
                { "label": "ğŸ”„ Between My Citi Accounts", "go_to_screen_id": "get_accounts" },
                { "label": "ğŸ¦ To Another Bank", "go_to_screen_id": "get_external_beneficiaries" },
                { "label": "ğŸ‘¤ To Someone Else (Zelle)", "go_to_screen_id": "zelle_transfer" },
                { "label": "âŒ Cancel", "go_to_screen_id": "end_flow" }
            ]
        },
        "get_accounts": {
            "screen_id": "get_accounts",
            "type": "API_CALL",
            "api_call": {
                "url": "https://api.citi.com/v1/accounts",
                "method": "GET",
                "mock_file": "mocks/mock_accounts.json",
                "save_response_to": "accounts"
            },
            "on_success": "select_from_account",
            "on_error": "api_error"
        },
        "select_from_account": {
            "screen_id": "select_from_account",
            "type": "MENU",
            "message_text": "Transfer FROM which account?",
            "dynamic_buttons": {
                "source_variable": "accounts.accounts",
                "label_template": "{{name}} (...{{last_four}}) - ${{balance}}",
                "go_to_screen_id": "select_to_account",
                "set_variable": "from_account"
            },
            "buttons": [
                { "label": "â¬…ï¸ Back", "go_to_screen_id": "select_transfer_type" }
            ]
        },
        "select_to_account": {
            "screen_id": "select_to_account",
            "type": "MENU",
            "message_text": "Transfer TO which account?",
            "dynamic_buttons": {
                "source_variable": "accounts.accounts",
                "label_template": "{{name}} (...{{last_four}})",
                "go_to_screen_id": "enter_transfer_amount",
                "set_variable": "to_account"
            },
            "buttons": [
                { "label": "â¬…ï¸ Back", "go_to_screen_id": "select_from_account" }
            ]
        },
        "enter_transfer_amount": {
            "screen_id": "enter_transfer_amount",
            "type": "MESSAGE",
            "message_text": "ğŸ’° How much would you like to transfer?\n\nFrom: {{from_account.name}} (...{{from_account.last_four}})\nAvailable: ${{from_account.balance}}",
            "input": {
                "type": "text",
                "variable": "transfer_amount"
            },
            "go_to_screen_id": "select_transfer_date"
        },
        "select_transfer_date": {
            "screen_id": "select_transfer_date",
            "type": "MENU",
            "message_text": "ğŸ“… When should this transfer occur?",
            "buttons": [
                { "label": "âš¡ Right Now", "go_to_screen_id": "review_transfer", "set_variable": "transfer_date", "set_value": "now" },
                { "label": "ğŸ“† Schedule for Later", "go_to_screen_id": "enter_schedule_date", "set_variable": "transfer_date", "set_value": "scheduled" },
                { "label": "ğŸ”„ Recurring Transfer", "go_to_screen_id": "setup_recurring" }
            ]
        },
        "enter_schedule_date": {
            "screen_id": "enter_schedule_date",
            "type": "MESSAGE",
            "message_text": "When would you like to schedule this transfer?\n\n(Enter date in MM/DD/YYYY format)",
            "input": {
                "type": "text",
                "variable": "scheduled_date"
            },
            "go_to_screen_id": "review_transfer"
        },
        "setup_recurring": {
            "screen_id": "setup_recurring",
            "type": "MENU",
            "message_text": "ğŸ”„ How often should this transfer occur?",
            "buttons": [
                { "label": "ğŸ“… Weekly", "go_to_screen_id": "review_transfer", "set_variable": "recurring_frequency", "set_value": "weekly" },
                { "label": "ğŸ“… Bi-Weekly", "go_to_screen_id": "review_transfer", "set_variable": "recurring_frequency", "set_value": "biweekly" },
                { "label": "ğŸ“… Monthly", "go_to_screen_id": "review_transfer", "set_variable": "recurring_frequency", "set_value": "monthly" }
            ]
        },
        "review_transfer": {
            "screen_id": "review_transfer",
            "type": "MENU",
            "message_text": "ğŸ“‹ Review Transfer:\n\nFrom: {{from_account.name}} (...{{from_account.last_four}})\nTo: {{to_account.name}} (...{{to_account.last_four}})\nAmount: ${{transfer_amount}}\nWhen: {{transfer_date}}\n\nâœ… This transfer will complete instantly.",
            "buttons": [
                { "label": "âœ… Confirm Transfer", "go_to_screen_id": "process_transfer" },
                { "label": "ğŸ“ Edit Amount", "go_to_screen_id": "enter_transfer_amount" },
                { "label": "âŒ Cancel", "go_to_screen_id": "end_flow" }
            ]
        },
        "process_transfer": {
            "screen_id": "process_transfer",
            "type": "API_CALL",
            "api_call": {
                "url": "https://api.citi.com/v1/transfers",
                "method": "POST",
                "mock_response": {
                    "status": "success",
                    "transfer_id": "TRF_8473920156",
                    "confirmation_number": "CONF847392",
                    "completed_at": "2025-11-11T10:30:00Z"
                }
            },
            "on_success": "transfer_success",
            "on_error": "transfer_error"
        },
        "transfer_success": {
            "screen_id": "transfer_success",
            "type": "MESSAGE",
            "message_text": "âœ… Transfer Complete!\n\nConfirmation #: CONF847392\n\nğŸ’° ${{transfer_amount}} transferred\nFrom: {{from_account.name}}\nTo: {{to_account.name}}\n\nNew balance in {{from_account.name}}: ${{from_account.balance - transfer_amount}}",
            "buttons": [
                { "label": "ğŸ”„ Make Another Transfer", "go_to_screen_id": "select_transfer_type" },
                { "label": "ğŸ“§ Email Receipt", "go_to_screen_id": "end_flow" },
                { "label": "ğŸ  Done", "go_to_screen_id": "end_flow" }
            ]
        },
        "get_external_beneficiaries": {
            "screen_id": "get_external_beneficiaries",
            "type": "API_CALL",
            "api_call": {
                "url": "https://api.citi.com/v1/beneficiaries",
                "method": "GET",
                "mock_file": "mocks/mock_beneficiaries.json",
                "save_response_to": "beneficiaries"
            },
            "on_success": "select_beneficiary",
            "on_error": "api_error"
        },
        "select_beneficiary": {
            "screen_id": "select_beneficiary",
            "type": "MENU",
            "message_text": "Select a beneficiary:",
            "dynamic_buttons": {
                "source_variable": "beneficiaries.beneficiaries",
                "label_template": "{{name}} - {{nickname}}",
                "go_to_screen_id": "enter_transfer_amount",
                "set_variable": "selected_beneficiary"
            },
            "buttons": [
                { "label": "â• Add New Beneficiary", "go_to_screen_id": "add_beneficiary" },
                { "label": "â¬…ï¸ Back", "go_to_screen_id": "select_transfer_type" }
            ]
        },
        "add_beneficiary": {
            "screen_id": "add_beneficiary",
            "type": "MESSAGE",
            "message_text": "To add a new beneficiary, you'll need their:\nâ€¢ Full name\nâ€¢ Bank routing number\nâ€¢ Account number\n\nThis will open in a secure form.",
            "buttons": [
                { "label": "âœ… Continue", "go_to_screen_id": "select_beneficiary" }
            ]
        },
        "zelle_transfer": {
            "screen_id": "zelle_transfer",
            "type": "MESSAGE",
            "message_text": "ğŸ’¸ ZelleÂ® Transfer\n\nSend money quickly to friends and family using their email or phone number.\n\nThis feature will open the Zelle interface.",
            "buttons": [
                { "label": "âœ… Open Zelle", "go_to_screen_id": "end_flow" },
                { "label": "â¬…ï¸ Back", "go_to_screen_id": "select_transfer_type" }
            ]
        },
        "transfer_error": {
            "screen_id": "transfer_error",
            "type": "MENU",
            "message_text": "âŒ Transfer Failed\n\nYour transfer could not be completed. This may be due to:\nâ€¢ Insufficient funds\nâ€¢ Daily transfer limit reached\nâ€¢ System error",
            "buttons": [
                { "label": "ğŸ”„ Try Again", "go_to_screen_id": "review_transfer" },
                { "label": "ğŸ“ Contact Support", "go_to_screen_id": "end_flow" }
            ]
        },
        "api_error": {
            "screen_id": "api_error",
            "type": "MESSAGE",
            "message_text": "âŒ Unable to retrieve information. Please try again later.",
            "go_to_screen_id": "end_flow"
        },
        "end_flow": {
            "screen_id": "end_flow",
            "type": "MESSAGE",
            "message_text": "Thank you for banking with Citi!",
            "go_to_screen_id": null
        }
    }
}

