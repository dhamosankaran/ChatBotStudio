{
    "start_screen_id": "get_rewards",
    "screens": {
        "get_rewards": {
            "screen_id": "get_rewards",
            "type": "API_CALL",
            "api_call": {
                "url": "https://api.citi.com/v1/rewards",
                "method": "GET",
                "mock_file": "mocks/mock_rewards.json",
                "save_response_to": "rewards"
            },
            "on_success": "show_rewards_balance",
            "on_error": "api_error"
        },
        "show_rewards_balance": {
            "screen_id": "show_rewards_balance",
            "type": "MENU",
            "message_text": "‚ú® ThankYou¬Æ Rewards\n\nüéÅ Available Points: {{rewards.rewards.total_points}}\nüèÜ Tier Status: {{rewards.rewards.tier_status}}\n\n‚ö†Ô∏è {{rewards.rewards.points_expiring_soon}} points expiring on {{rewards.rewards.expiration_date}}",
            "buttons": [
                { "label": "üíµ Redeem Points", "go_to_screen_id": "select_redemption_type" },
                { "label": "üìä View Activity", "go_to_screen_id": "view_activity" },
                { "label": "‚ùå Cancel", "go_to_screen_id": "end_flow" }
            ]
        },
        "select_redemption_type": {
            "screen_id": "select_redemption_type",
            "type": "MENU",
            "message_text": "How would you like to redeem your {{rewards.rewards.total_points}} points?",
            "dynamic_buttons": {
                "source_variable": "rewards.redemption_options",
                "label_template": "{{icon}} {{name}} (Min: {{min_points}} pts)",
                "go_to_screen_id": "enter_redemption_amount",
                "set_variable": "redemption_option"
            },
            "buttons": [
                { "label": "‚¨ÖÔ∏è Back", "go_to_screen_id": "show_rewards_balance" }
            ]
        },
        "enter_redemption_amount": {
            "screen_id": "enter_redemption_amount",
            "type": "MESSAGE",
            "message_text": "{{redemption_option.icon}} {{redemption_option.name}}\n\n{{redemption_option.description}}\n\nAvailable Points: {{rewards.rewards.total_points}}\nMinimum: {{redemption_option.min_points}} points\nValue: 1 point = ${{100 / redemption_option.conversion_rate}}\n\nHow many points would you like to redeem?",
            "input": {
                "type": "text",
                "variable": "points_to_redeem"
            },
            "go_to_screen_id": "show_redemption_value"
        },
        "show_redemption_value": {
            "screen_id": "show_redemption_value",
            "type": "MENU",
            "message_text": "üìã Redemption Summary:\n\nPoints to Redeem: {{points_to_redeem}}\nRedemption Type: {{redemption_option.name}}\nValue: ${{points_to_redeem * 100 / redemption_option.conversion_rate}}\n\nRemaining Points: {{rewards.rewards.total_points - points_to_redeem}}",
            "buttons": [
                { "label": "‚úÖ Confirm Redemption", "go_to_screen_id": "process_redemption" },
                { "label": "üìù Change Amount", "go_to_screen_id": "enter_redemption_amount" },
                { "label": "‚ùå Cancel", "go_to_screen_id": "end_flow" }
            ]
        },
        "process_redemption": {
            "screen_id": "process_redemption",
            "type": "API_CALL",
            "api_call": {
                "url": "https://api.citi.com/v1/rewards/redeem",
                "method": "POST",
                "mock_response": {
                    "status": "success",
                    "redemption_id": "RED_8473920156",
                    "confirmation_number": "CONF847392",
                    "redemption_value": 100.00,
                    "processing_time": "3-5 business days"
                }
            },
            "on_success": "redemption_success",
            "on_error": "redemption_error"
        },
        "redemption_success": {
            "screen_id": "redemption_success",
            "type": "MESSAGE",
            "message_text": "üéâ Redemption Successful!\n\nConfirmation #: CONF847392\n\nRedeemed: {{points_to_redeem}} points\nValue: $100.00\nType: {{redemption_option.name}}\n\n‚úÖ Your redemption will be processed within 3-5 business days.\n\nNew Points Balance: {{rewards.rewards.total_points - points_to_redeem}}",
            "buttons": [
                { "label": "üîÑ Redeem More Points", "go_to_screen_id": "show_rewards_balance" },
                { "label": "üìß Email Confirmation", "go_to_screen_id": "end_flow" },
                { "label": "üè† Done", "go_to_screen_id": "end_flow" }
            ]
        },
        "view_activity": {
            "screen_id": "view_activity",
            "type": "MENU",
            "message_text": "üìä Recent Rewards Activity:\n\n‚úÖ Oct 15, 2025\nRedeemed: 10,000 points\nType: Statement Credit\nValue: $100.00\n\nüéÅ Points earned this year: {{rewards.rewards.points_earned_ytd}}",
            "buttons": [
                { "label": "‚¨ÖÔ∏è Back to Rewards", "go_to_screen_id": "show_rewards_balance" },
                { "label": "üè† Done", "go_to_screen_id": "end_flow" }
            ]
        },
        "redemption_error": {
            "screen_id": "redemption_error",
            "type": "MENU",
            "message_text": "‚ùå Unable to Process Redemption\n\nYour redemption could not be processed. Please verify:\n‚Ä¢ You have enough points\n‚Ä¢ Amount meets minimum requirement\n‚Ä¢ Points are not expired or pending",
            "buttons": [
                { "label": "üîÑ Try Again", "go_to_screen_id": "enter_redemption_amount" },
                { "label": "üìû Contact Support", "go_to_screen_id": "end_flow" }
            ]
        },
        "api_error": {
            "screen_id": "api_error",
            "type": "MESSAGE",
            "message_text": "‚ùå Unable to retrieve your rewards information. Please try again later.",
            "go_to_screen_id": "end_flow"
        },
        "end_flow": {
            "screen_id": "end_flow",
            "type": "MESSAGE",
            "message_text": "Thank you for being a valued Citi customer!",
            "go_to_screen_id": null
        }
    }
}

